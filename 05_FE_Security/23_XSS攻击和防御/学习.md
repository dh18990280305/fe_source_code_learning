# XSS 攻击原理与防御

## 一、XSS 定义
XSS 跨站脚本攻击，攻击者向页面注入恶意脚本并执行，实现窃取信息、劫持用户、篡改页面等攻击。

## 二、三种 XSS 类型

### 1. 存储型 XSS（最危险）
- 恶意数据存入数据库
- 所有访问页面的用户都会执行
- 常见场景：评论、留言、用户昵称

### 2. 反射型 XSS
- 恶意代码在 URL 参数中
- 用户点击链接才触发
- 常见场景：搜索框、参数回显

### 3. DOM 型 XSS
- 纯前端从 URL 取数据并插入 DOM
- 不经过服务器、不进数据库
- 属于前端安全漏洞

## 三、核心防御手段
1. **输入校验**：前后端同时过滤危险字符
2. **输出转义**：渲染到HTML前转义 < > " ' &
3. **避免危险API**：少用 innerHTML、eval、document.write
4. **HttpOnly Cookie**：防止JS读取登录Cookie
5. **CSP 内容安全策略**：白名单控制脚本来源
6. 使用 Vue/React 等框架，利用自动转义机制

## 四、一句话记住
**输入做校验，输出必转义，危险API不用，Cookie 加 HttpOnly，CSP 做兜底。**


### 今日刷题（3 题，15 分钟）
#### 题 1：存储型、反射型、DOM 型 XSS 区别？
答案：
- 存储型：脚本存入数据库，所有人访问都会触发，危害最大。
- 反射型：脚本在 URL 里，仅点击链接的用户触发。
- DOM 型：纯前端拼接 DOM 触发，不经过后端。

#### 题 2：XSS 最核心的防御手段是什么？
答案：
- 对输出到页面的内容进行 HTML 转义。
- 同时配合：输入校验、HttpOnly、CSP、避免危险 DOM 操作。


#### 题 3：实际项目中你怎么做 XSS 防御？（中厂高频）
答案（标准满分）：
- 用户输入前后端都校验，过滤危险标签与事件
- 所有动态渲染内容强制转义
- 不使用 innerHTML、eval 等危险 API
- 登录 Cookie 设置 HttpOnly
- 配置 CSP 限制脚本来源
- 使用 Vue/React 等自动转义的框架